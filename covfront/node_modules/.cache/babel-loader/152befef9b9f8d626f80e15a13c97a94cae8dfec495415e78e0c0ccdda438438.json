{"ast":null,"code":"var _jsxFileName = \"D:\\\\covoiturageGithub\\\\CovoiturageApp\\\\covfront\\\\src\\\\components\\\\MapComponent.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MapComponent = ({\n  from,\n  to,\n  onFromChange,\n  onToChange\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const markerFromRef = useRef(null);\n  const markerToRef = useRef(null);\n  useEffect(() => {\n    // Load Leaflet if not already loaded\n    if (!window.L) {\n      const leafletScript = document.createElement(\"script\");\n      leafletScript.src = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\";\n      document.head.appendChild(leafletScript);\n      const leafletCSS = document.createElement(\"link\");\n      leafletCSS.rel = \"stylesheet\";\n      leafletCSS.href = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\";\n      document.head.appendChild(leafletCSS);\n      leafletScript.onload = initializeMap;\n    } else {\n      initializeMap();\n    }\n    function initializeMap() {\n      if (!mapRef.current) {\n        mapRef.current = window.L.map(\"map\").setView([36.8065, 10.1815], 6); // Default to Tunisia\n        window.L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n          maxZoom: 19,\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        }).addTo(mapRef.current);\n        markerFromRef.current = window.L.marker([36.8065, 10.1815], {\n          draggable: true\n        }).addTo(mapRef.current);\n        markerToRef.current = window.L.marker([36.8065, 10.1815], {\n          draggable: true\n        }).addTo(mapRef.current);\n        markerFromRef.current.on(\"dragend\", e => {\n          const latlng = e.target.getLatLng();\n          reverseGeocode(latlng, onFromChange);\n        });\n        markerToRef.current.on(\"dragend\", e => {\n          const latlng = e.target.getLatLng();\n          reverseGeocode(latlng, onToChange);\n        });\n        updateMapFromFields();\n      }\n    }\n    function updateMapFromFields() {\n      if (from && markerFromRef.current) {\n        geocode(from, latlng => {\n          if (latlng) {\n            markerFromRef.current.setLatLng(latlng).update();\n            if (markerToRef.current) mapRef.current.fitBounds([markerFromRef.current.getLatLng(), markerToRef.current.getLatLng()]);\n          }\n        });\n      }\n      if (to && markerToRef.current) {\n        geocode(to, latlng => {\n          if (latlng) {\n            markerToRef.current.setLatLng(latlng).update();\n            if (markerFromRef.current) mapRef.current.fitBounds([markerFromRef.current.getLatLng(), markerToRef.current.getLatLng()]);\n          }\n        });\n      }\n    }\n    function geocode(address, callback) {\n      fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`).then(response => response.json()).then(data => {\n        if (data && data.length > 0) {\n          const {\n            lat,\n            lon\n          } = data[0];\n          callback({\n            lat: parseFloat(lat),\n            lng: parseFloat(lon)\n          });\n        }\n      }).catch(error => console.error(\"Geocoding error:\", error));\n    }\n    function reverseGeocode(latlng, callback) {\n      fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latlng.lat}&lon=${latlng.lng}`).then(response => response.json()).then(data => {\n        if (data && data.display_name) {\n          callback(data.display_name.split(\",\")[0]); // Use the first part as city name\n        }\n      }).catch(error => console.error(\"Reverse geocoding error:\", error));\n    }\n\n    // Update map when from or to changes\n    updateMapFromFields();\n  }, [from, to, onFromChange, onToChange]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"map\",\n    style: {\n      height: \"400px\",\n      width: \"100%\",\n      margin: \"20px 0\",\n      borderRadius: \"10px\",\n      overflow: \"hidden\"\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this);\n};\n_s(MapComponent, \"ifWam7wslNxu6mmnSNWjzLulDqo=\");\n_c = MapComponent;\nexport default MapComponent;\nvar _c;\n$RefreshReg$(_c, \"MapComponent\");","map":{"version":3,"names":["useEffect","useRef","jsxDEV","_jsxDEV","MapComponent","from","to","onFromChange","onToChange","_s","mapRef","markerFromRef","markerToRef","window","L","leafletScript","document","createElement","src","head","appendChild","leafletCSS","rel","href","onload","initializeMap","current","map","setView","tileLayer","maxZoom","attribution","addTo","marker","draggable","on","e","latlng","target","getLatLng","reverseGeocode","updateMapFromFields","geocode","setLatLng","update","fitBounds","address","callback","fetch","encodeURIComponent","then","response","json","data","length","lat","lon","parseFloat","lng","catch","error","console","display_name","split","id","style","height","width","margin","borderRadius","overflow","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/covoiturageGithub/CovoiturageApp/covfront/src/components/MapComponent.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\n\nconst MapComponent = ({ from, to, onFromChange, onToChange }) => {\n  const mapRef = useRef(null);\n  const markerFromRef = useRef(null);\n  const markerToRef = useRef(null);\n\n  useEffect(() => {\n    // Load Leaflet if not already loaded\n    if (!window.L) {\n      const leafletScript = document.createElement(\"script\");\n      leafletScript.src = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\";\n      document.head.appendChild(leafletScript);\n\n      const leafletCSS = document.createElement(\"link\");\n      leafletCSS.rel = \"stylesheet\";\n      leafletCSS.href = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\";\n      document.head.appendChild(leafletCSS);\n\n      leafletScript.onload = initializeMap;\n    } else {\n      initializeMap();\n    }\n\n    function initializeMap() {\n      if (!mapRef.current) {\n        mapRef.current = window.L.map(\"map\").setView([36.8065, 10.1815], 6); // Default to Tunisia\n        window.L.tileLayer(\n          \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n          {\n            maxZoom: 19,\n            attribution:\n              '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n          }\n        ).addTo(mapRef.current);\n\n        markerFromRef.current = window.L.marker([36.8065, 10.1815], {\n          draggable: true,\n        }).addTo(mapRef.current);\n        markerToRef.current = window.L.marker([36.8065, 10.1815], {\n          draggable: true,\n        }).addTo(mapRef.current);\n\n        markerFromRef.current.on(\"dragend\", (e) => {\n          const latlng = e.target.getLatLng();\n          reverseGeocode(latlng, onFromChange);\n        });\n\n        markerToRef.current.on(\"dragend\", (e) => {\n          const latlng = e.target.getLatLng();\n          reverseGeocode(latlng, onToChange);\n        });\n\n        updateMapFromFields();\n      }\n    }\n\n    function updateMapFromFields() {\n      if (from && markerFromRef.current) {\n        geocode(from, (latlng) => {\n          if (latlng) {\n            markerFromRef.current.setLatLng(latlng).update();\n            if (markerToRef.current)\n              mapRef.current.fitBounds([\n                markerFromRef.current.getLatLng(),\n                markerToRef.current.getLatLng(),\n              ]);\n          }\n        });\n      }\n      if (to && markerToRef.current) {\n        geocode(to, (latlng) => {\n          if (latlng) {\n            markerToRef.current.setLatLng(latlng).update();\n            if (markerFromRef.current)\n              mapRef.current.fitBounds([\n                markerFromRef.current.getLatLng(),\n                markerToRef.current.getLatLng(),\n              ]);\n          }\n        });\n      }\n    }\n\n    function geocode(address, callback) {\n      fetch(\n        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(\n          address\n        )}`\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          if (data && data.length > 0) {\n            const { lat, lon } = data[0];\n            callback({ lat: parseFloat(lat), lng: parseFloat(lon) });\n          }\n        })\n        .catch((error) => console.error(\"Geocoding error:\", error));\n    }\n\n    function reverseGeocode(latlng, callback) {\n      fetch(\n        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latlng.lat}&lon=${latlng.lng}`\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          if (data && data.display_name) {\n            callback(data.display_name.split(\",\")[0]); // Use the first part as city name\n          }\n        })\n        .catch((error) => console.error(\"Reverse geocoding error:\", error));\n    }\n\n    // Update map when from or to changes\n    updateMapFromFields();\n  }, [from, to, onFromChange, onToChange]);\n\n  return (\n    <div\n      id=\"map\"\n      style={{\n        height: \"400px\",\n        width: \"100%\",\n        margin: \"20px 0\",\n        borderRadius: \"10px\",\n        overflow: \"hidden\",\n      }}\n    ></div>\n  );\n};\n\nexport default MapComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}